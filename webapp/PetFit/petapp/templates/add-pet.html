{% if messages %}
<div id="messages-container">
    {% for message in messages %}
        <div class="alert {{ message.tags }}">
            {{ message }}
        </div>
    {% endfor %}
</div>
{% endif %}

{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Pet</title>

  <!-- CSS + Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="{% static "petapp/css/styles.css" %}" rel="stylesheet">
</head>
<body>

<style>
    /* General button hover (except cross) */
button:hover {
  background-color: #DA7E66 !important;
  color: white !important;
  border-color: #DA7E66 !important;
}

</style>

<header>
  <div class="banner">Because Every Pet Deserves Free Care.</div>
  <nav>
        
      <div id="logo">
          <svg width="40" height="32" viewBox="0 0 40 32" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M12.8 32H0V21.9849C0 17.1239 4.0116 13.1839 8.96 13.1839H15.2V0.468341C15.2 0.251458 15.3792 0.0754376 15.6 0.0754376C15.7184 0.0754376 15.8308 0.127301 15.9068 0.216883L17.3616 1.92719C18.402 1.07577 19.74 0.563816 21.2 0.563816H22C23.442 0.563816 24.7656 1.06359 25.8 1.89654L27.2932 0.14066C27.3692 0.0514706 27.4812 0 27.6 0C27.8208 0 28 0.175628 28 0.392904V15.3896H23.36C17.528 15.3896 12.8 20.0337 12.8 25.7623V32Z" fill="#45413E" />
              <path fill-rule="evenodd" clip-rule="evenodd" d="M29.76 17.0569V12.0875C29.76 12.0836 29.76 12.0797 29.76 12.0758V6.79004C29.76 6.57435 29.9392 6.4 30.16 6.4C30.266 6.4 30.3676 6.44095 30.4424 6.51389L31.9576 7.98784C32.7864 7.42501 33.7936 7.09504 34.88 7.09504C35.97 7.09504 36.9808 7.42735 37.8112 7.99369L39.3176 6.52793C39.3924 6.45499 39.494 6.41404 39.6 6.41404C39.8208 6.41404 40 6.58878 40 6.80408V23.2632C40 28.0883 35.9884 32 31.04 32H14.4V25.7938C14.4 20.969 18.4116 17.0569 23.36 17.0569H29.76Z" fill="#45413E" />
          </svg>

          PetFit Ai
      </div>
      <ul class="navigation-menu">
          <li><a href="{% url "mainpage" %}">Home</a></li>
              <li><a href="{% url "addPet" %}">Add Pet</a></li>
              <li><a href="{% url "chat" %}">PetFit Agent</a></li>
              <li><a href="{% url "dashboard" %}">Dashboard</a></li>
      </ul>
      <div id="utility">
          {% if request.user.is_authenticated %}
          <a href="{% url "logout" %}" class="tooltip">
            <span class="material-symbols-outlined">logout</span>
            <span class="tooltip-text">Logout</span>
          </a>
          {% else %}
          <div class="btn-group">
              <button class="btn-outline-dark btn-hover-color" onclick="window.location.href='{% url 'login' %}'">
                  <span class="material-symbols-outlined">login</span> Login/Signup
              </button>
          </div>
          {% endif %}
      </div>
  </nav>
</header>

  <!-- Main Content -->
<main class="p-6 space-y-12">

    <!-- Pets + Add Form side by side -->
    <section class="grid md:grid-cols-2 gap-10">
      
     <!-- Pet List -->
<div>
    <h2 class="text-2xl font-semibold text-center mb-6">My Pets</h2>
    <div class="grid grid-cols-2 gap-6">

    {% for pet in all_pets %}
      <div class="card-large p-4 relative bg-white rounded-xl shadow-md overflow-hidden">
          <!-- Close Button -->
          <button onclick="removeCard(this)" 
                  class="absolute top-2 right-2 z-10 bg-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-500 hover:text-white transition">
          &times;
          </button>
      
          <div class="card-image bg-gray-100 relative">
          {% if pet.pet_type == "Dog" %}
              <img src="https://ouch-cdn2.icons8.com/qPvaAv2gxwM3l0z7dl_eoh9v6h58HlzewBUfEgX6AZE/rs:fit:368:386/czM6Ly9pY29uczgu/b3VjaC1wcm9kLmFz/c2V0cy9wbmcvMTIv/ZmM4YjNlYmItMDNj/Ni00NGM3LTliNGUt/YTUyOWUzOGU4NTE2/LnBuZw.png" alt="Dog" class="w-full">
          {% elif pet.pet_type == "Cat" %}
              <img src="https://ouch-cdn2.icons8.com/US6gJ6fHUOJqruLB7KDe5zEa82iDSp7OdO-bv-aLtvU/rs:fit:368:310/czM6Ly9pY29uczgu/b3VjaC1wcm9kLmFz/c2V0cy9wbmcvNjU5/LzdmOWU1ZjU0LTMx/ZDQtNDgwNS1iM2E2/LWM3NzgyMTcyNzJh/NC5wbmc.png" alt="Cat" class="w-full">
          {% elif pet.pet_type == "Hamster" %}
              <img src="{% static "petapp/images/hamster.png" %}" alt="Hamster" class="w-full">
          {% elif pet.pet_type == "Bird" %}
              <img src="{% static "petapp/images/bird.png" %}" alt="Parrot" class="w-full">
          {% endif %}
          </div>
      
          <ul class="mt-2">
          <li>{{pet.name}}</li>
          <li class="text-sm text-gray-600">Age: {{pet.age}}</li>
          <li class="text-sm italic text-gray-500">"{{pet.notes}}"</li>
          </ul>
          <!-- Edit Button -->
          <button type="button" class="btn-outline-dark edit-btn" onclick="editDetails('{{pet.pet_id}}')">Edit Details</button>
      </div>
    
    {% endfor %}

    <!-- Pet Card 2 -->
    <div class="card-large p-4 relative bg-white rounded-xl shadow-md overflow-hidden">
        <!-- Close Button -->
        <button onclick="removeCard(this)" 
                class="absolute top-2 right-2 z-10 bg-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-500 hover:text-white transition">
        &times;
        </button>
    
        <div class="card-image bg-gray-100 relative">
        <img src="https://ouch-cdn2.icons8.com/US6gJ6fHUOJqruLB7KDe5zEa82iDSp7OdO-bv-aLtvU/rs:fit:368:310/czM6Ly9pY29uczgu/b3VjaC1wcm9kLmFz/c2V0cy9wbmcvNjU5/LzdmOWU1ZjU0LTMx/ZDQtNDgwNS1iM2E2/LWM3NzgyMTcyNzJh/NC5wbmc.png" alt="Cat" class="w-full">
        </div>
    
        <ul class="mt-2">
        <li>Whiskers</li>
        <li class="text-sm text-gray-600">Age: 2 years 3 months</li>
        <li class="text-sm italic text-gray-500">"Loves running in the park"</li>
        </ul>

        <!-- Edit Button -->
        <button type="button" class="btn-outline-dark edit-btn">Edit Details</button>
    </div>

    <!-- Pet Card 3 -->
    <div class="card-large p-4 relative bg-white rounded-xl shadow-md overflow-hidden">
        <!-- Close Button -->
        <button onclick="removeCard(this)" 
                class="absolute top-2 right-2 z-10 bg-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-500 hover:text-white transition">
        &times;
        </button>
    
        <div class="card-image bg-gray-100 relative">
        <img src="{% static "petapp/images/bird.png" %}" alt="Parrot" class="w-full">
        </div>
    
        <ul class="mt-2">
        <li>Polly</li>
        <li class="text-sm text-gray-600">Age: 2 years 3 months</li>
        <li class="text-sm italic text-gray-500">"Loves running in the park"</li>
        </ul>

        <!-- Edit Button -->
        <button type="button" class="btn-outline-dark edit-btn">Edit Details</button>
    </div>
    
  
      <!-- Pet Card 4 -->
      <div class="card-large p-4 relative bg-white rounded-xl shadow-md overflow-hidden">
        <!-- Close Button -->
        <button onclick="removeCard(this)" 
                class="absolute top-2 right-2 z-10 bg-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-500 hover:text-white transition">
        &times;
        </button>
        <div class="card-image bg-gray-100">
          <img src="{% static "petapp/images/hamster.png" %}" alt="Fish" class="w-full">
        </div>
        <ul>
          <li>Goldie</li>
          <li class="text-sm text-gray-600">Age: 2 years 3 months</li>
        <li class="text-sm italic text-gray-500">"Loves running in the park"</li>
        </ul>
        <!-- Edit Button -->
        <button type="button" class="btn-outline-dark edit-btn">Edit Details</button>
      </div>
  
    </div>
  </div>
  
  
      <!-- Add New Pet Form -->
      <div>
        <h2 class="text-2xl font-semibold text-center mb-6">Add New Pet</h2>
        <form class="max-w-md mx-auto bg-white p-6 rounded-xl shadow-md space-y-4" action="{% url 'addPet' %}" method="POST" id="addPetForm">
        {% csrf_token %}
          <div>
            <label class="block font-medium mb-1">Pet Name</label>
            <input type="text" name="pet_name" class="w-full border rounded-lg px-3 py-2" placeholder="Enter pet name">
          </div>
          <div>
            <label class="block font-medium mb-1">Pet Type</label>
            <select class="w-full border rounded-lg px-3 py-2" name="pet_type">
              <option>Dog</option>
              <option>Cat</option>
              <option>Bird</option>
              <option>Hamster</option>
            </select>
          </div>
          <div>
            <label class="block font-medium mb-1">Gender</label>
            <select class="w-full border rounded-lg px-3 py-2" name="pet_gender">
              <option>Male</option>
              <option>Female</option>
              <option>Other</option>
            </select>
          </div>
          <div>
            <label class="block font-medium mb-1">Age</label>
            <div class="flex gap-4">
              <input type="number" min="0" class="w-1/2 border rounded-lg px-3 py-2" placeholder="Years" name="pet_years">
              <input type="number" min="0" max="11" class="w-1/2 border rounded-lg px-3 py-2" placeholder="Months" name="pet_months">
            </div>
          </div>
          <div>
            <label class="block font-medium mb-1">Notes</label>
            <textarea class="w-full border rounded-lg px-3 py-2" rows="3" placeholder="Add any special notes (e.g., allergies, favorite food, behavior)" name="pet_notes"></textarea>
          </div>
          
          <button type="submit" class="btn-outline-dark w-full">Add Pet</button>
        </form>
      </div>
  
    </section>

    <!-- Edit Pet Modal -->
<div id="editModal" class="fixed inset-0 hidden bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl shadow-md w-full max-w-lg relative">
      <!-- Close Button -->
      <button onclick="closeEditModal()" class="absolute top-3 right-3 text-gray-600 hover:text-red-500 text-xl font-bold">✕</button>
      
      <h2 class="text-2xl font-semibold text-center mb-6">Edit Pet</h2>
      <form class="space-y-4" action="{% url 'updatePetInfo' %}" method="POST" id="updatePetInfoForm">
        {% csrf_token %}
        <div hidden="true">
          <input type="text" class="w-full border rounded-lg px-3 py-2" name="pet_id" id="pet_id">
        </div>
        <div>
          <label class="block font-medium mb-1">Pet Name</label>
          <input type="text" class="w-full border rounded-lg px-3 py-2" name="editName" id="editName" placeholder="Enter pet name">
        </div>
        <div>
          <label class="block font-medium mb-1">Pet Type</label>
          <select class="w-full border rounded-lg px-3 py-2" name="editType" id="editType">
            <option>Dog</option>
            <option>Cat</option>
            <option>Bird</option>
            <option>Hamster</option>
          </select>
        </div>
        <div>
          <label class="block font-medium mb-1">Pet Gender</label>
          <select class="w-full border rounded-lg px-3 py-2" name="editGender" id="editGender">
            <option>Male</option>
            <option>Female</option>
            <option>Other</option>
          </select>
        </div>
        <div>
          <label class="block font-medium mb-1">Age</label>
          <div class="flex gap-4">
            <input type="number" name="editYears" id="editYears" min="0" class="w-1/2 border rounded-lg px-3 py-2" placeholder="Years">
            <input type="number" name="editMonths" id="editMonths" min="0" max="11" class="w-1/2 border rounded-lg px-3 py-2" placeholder="Months">
          </div>
        </div>
        <div>
          <label class="block font-medium mb-1">Notes</label>
          <textarea class="w-full border rounded-lg px-3 py-2" name="editNotes" id="editNotes" rows="3" placeholder="Add any special notes"></textarea>
        </div>
        
        <button type="submit" class="btn-outline-dark w-full">Save Changes</button>
      </form>
    </div>
  </div>
  
    <!-- Connect Collar stays below -->
    <section id="locate">
      <div>
        <h2>Connect Pet’s Collar</h2>
        <p>Link your pet’s smart collar to track health, location, and activities directly from your dashboard.</p>
        <button class="btn-outline-dark">Connect Now</button>
      </div>
    </section>
  
  </main>
  

  <!-- Footer -->
  <footer>
    <ul>
      Features
      <li><a href="{% url "mainpage" %}">Home</a></li>
      <li><a href="{% url "dashboard" %}">Dashboard</a></li>
      <li><a href="{% url "addPet" %}">Add Pet</a></li>
      <li><a href="{% url "chat" %}">PetFit Agent</a></li>
    </ul>
  
    <ul>
      Resources
      <li><a href="#">Blog</a></li>
      <li><a href="#">FAQs</a></li>
      <li><a href="#">Support</a></li>
    </ul>
  
    <ul>
      Account
      <li><a href="{% url "login" %}">Login</a></li>
      <li><a href="{% url "login" %}">Signup</a></li>
    </ul>
  
    <ul>
      Company
      <li><a href="#">About Us</a></li>
      <li><a href="#">Contact</a></li>
    </ul>
  
  </footer>

<script>
    function removeCard(button) {
      // Find the card (parent div) and remove it
      const card = button.closest('.card-large');
      if (card) {
        card.remove();
      }
    }

    function editDetails(pet_id) {
      document.getElementById("editModal").classList.remove("hidden");
      fetch(`/petinfo/${pet_id}`)
        .then(response => response.json())
        .then(data => {
            document.getElementById("pet_id").value = data.pet_id;
            document.getElementById("editName").value = data.name;
            document.getElementById("editYears").value = data.age_years;
            document.getElementById("editMonths").value = data.age_months;
            document.getElementById("editGender").value = data.gender;
            document.getElementById("editNotes").value = data.notes;
            document.getElementById("editType").value = data.pet_type;
        })
        .catch(error => console.error("Error fetching pet data:", error));
    }

    // Close modal
    function closeEditModal() {
        document.getElementById("editModal").classList.add("hidden");
    }
  </script>
  
<script src="{% static "petapp/js/base.js" %}"></script>

</body>
</html>
