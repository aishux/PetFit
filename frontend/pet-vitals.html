<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Pet Activity Dashboard (No React)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link href="styles.css" rel="stylesheet">
  <link href="pet-vitals.css" rel="stylesheet">
</head>
<body>
  <main>
    <!-- SVG Sprites for icons used inside the Activity Card -->
    <svg width="0" height="0" aria-hidden="true">
      <symbol id="arrow-up-right" viewBox="0 0 21 21">
        <path fill="currentcolor" fill-rule="evenodd" clip-rule="evenodd" d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM16 14C16 14.5523 15.5523 15 15 15C14.4477 15 14 14.5523 14 14V11.4142L9.70711 15.7071C9.31658 16.0976 8.68342 16.0976 8.29289 15.7071C7.90237 15.3166 7.90237 14.6834 8.29289 14.2929L12.5858 10H10C9.44772 10 9 9.55228 9 9C9 8.44772 9.44772 8 10 8H14.6717C15.4054 8 16 8.59489 16 9.32837V14Z" transform="translate(-1.5,-1.5)" />
      </symbol>
      <symbol id="arrow-right" viewBox="0 0 21 21">
        <path fill="currentcolor" fill-rule="evenodd" clip-rule="evenodd" d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM16 14C16 14.5523 15.5523 15 15 15C14.4477 15 14 14.5523 14 14V11.4142L9.70711 15.7071C9.31658 16.0976 8.68342 16.0976 8.29289 15.7071C7.90237 15.3166 7.90237 14.6834 8.29289 14.2929L12.5858 10H10C9.44772 10 9 9.55228 9 9C9 8.44772 9.44772 8 10 8H14.6717C15.4054 8 16 8.59489 16 9.32837V14Z" transform="rotate(45,10.5,10.5) translate(-1.5,-1.5)" />
      </symbol>
      <symbol id="arrow-down-right" viewBox="0 0 21 21">
        <path fill="currentcolor" fill-rule="evenodd" clip-rule="evenodd" d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM16 14C16 14.5523 15.5523 15 15 15C14.4477 15 14 14.5523 14 14V11.4142L9.70711 15.7071C9.31658 16.0976 8.68342 16.0976 8.29289 15.7071C7.90237 15.3166 7.90237 14.6834 8.29289 14.2929L12.5858 10H10C9.44772 10 9 9.55228 9 9C9 8.44772 9.44772 8 10 8H14.6717C15.4054 8 16 8.59489 16 9.32837V14Z" transform="rotate(90,10.5,10.5) translate(-1.5,-1.5)" />
      </symbol>
      <symbol id="more" viewBox="0 0 24 24">
        <g fill="currentcolor">
          <circle cx="3" cy="12" r="1.5" />
          <circle cx="12" cy="12" r="1.5" />
          <circle cx="21" cy="12" r="1.5" />
        </g>
      </symbol>
    </svg>

    <!-- Left: Select Pets -->
    <ul class="subnav right" style="margin-left: 100px;">
      <li class="card-med" id="sup-dog" data-pet="dog">
        <div class="card-image"><img alt="Dog" src="https://ouch-cdn2.icons8.com/qPvaAv2gxwM3l0z7dl_eoh9v6h58HlzewBUfEgX6AZE/rs:fit:368:386/czM6Ly9pY29uczgu/b3VjaC1wcm9kLmFz/c2V0cy9wbmcvMTIv/ZmM4YjNlYmItMDNj/Ni00NGM3LTliNGUt/YTUyOWUzOGU4NTE2/LnBuZw.png"></div>
        <a href="#" onclick="return false;">
          <span>Dogs</span>
          <span>Try Now <span class="material-symbols-outlined">arrow_forward</span></span>
        </a>
      </li>
      <li class="card-med" id="sup-cat" data-pet="cat">
        <div class="card-image"><img alt="Cat" src="https://ouch-cdn2.icons8.com/US6gJ6fHUOJqruLB7KDe5zEa82iDSp7OdO-bv-aLtvU/rs:fit:368:310/czM6Ly9pY29uczgu/b3VjaC1wcm9kLmFz/c2V0cy9wbmcvNjU5/LzdmOWU1ZjU0LTMx/ZDQtNDgwNS1iM2E2/LWM3NzgyMTcyNzJh/NC5wbmc.png"></div>
        <a href="#" onclick="return false;">
          <span>Cats</span>
          <span>Try Now <span class="material-symbols-outlined">arrow_forward</span></span>
        </a>
      </li>
      <li class="card-med" id="sup-bird" data-pet="bird">
        <div class="card-image"><img alt="Bird" src="https://ouch-cdn2.icons8.com/6OkSfKKP476ZKzGJoDlXfXuWzX-vjlDRotIVMTz3lmo/rs:fit:368:396/czM6Ly9pY29uczgu/b3VjaC1wcm9kLmFz/c2V0cy9wbmcvNzA1/LzRkNmI1YjIwLTQy/YWQtNDVlMC05ZDI5/LTA0MTkyMWZkNWE1/NS5wbmc.png"></div>
        <a href="#" onclick="return false;">
          <span>Birds</span>
          <span>Try Now <span class="material-symbols-outlined">arrow_forward</span></span>
        </a>
      </li>
      <li class="card-med" id="sup-hamster" data-pet="hamster">
        <div class="card-image"><img alt="Hamster" src="images/hamster.png"></div>
        <a href="#" onclick="return false;">
          <span>Hamster</span>
          <span>Try Now <span class="material-symbols-outlined">arrow_forward</span></span>
        </a>
      </li>
    </ul>

    <!-- Right: Activity Card -->
    <div id="activity-slot" class="activity" style="margin-left: 200px;"></div>
  </main>

  <script>
    const LOCALE = 'en-US';

    // ---------- Data Generation per Pet ----------
    function generatePetData(pet) {
      const ranges = {
        dog: [10000, 50000],
        cat: [5000, 20000],
        bird: [1000, 8000],
        hamster: [500, 3000],
      };
      const [min, max] = ranges[pet] || [1000, 10000];
      const items = [];
      for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        items.push({ date, viewers: Math.round(Math.random() * (max - min) + min) });
      }
      return items;
    }

    // ---------- Render Activity Card ----------
    const slot = document.getElementById('activity-slot');

    function formatShortDate(date) {
      return new Intl.DateTimeFormat(LOCALE, { month: '2-digit', day: 'numeric' }).format(date);
    }
    function compactNumber(n) { return new Intl.NumberFormat(LOCALE, { notation: 'compact' }).format(n); }
    function pct(n) { return new Intl.NumberFormat(LOCALE, { maximumFractionDigits: 1, style: 'percent' }).format(n); }

    function hueForFraction(frac) {
      // Thresholds like original: 0, .2, .4, .6, .8 â†’ hues 3,33,253,223,193
      const map = [
        { percent: 0.8, hue: 193 },
        { percent: 0.6, hue: 223 },
        { percent: 0.4, hue: 253 },
        { percent: 0.2, hue: 33 },
        { percent: 0,   hue: 3 },
      ];
      for (const m of map) if (frac > m.percent) return m.hue;
      return 3;
    }

    function renderActivityCard(data) {
      // compute week slice (7 days), max viewers rounded up to next 10,000
      const viewersOfWeek = data.slice(-7);
      const mostViewers = Math.max(...viewersOfWeek.map(d => d.viewers));
      const viewersMax = Math.max(1, Math.ceil(mostViewers / 1e4) * 1e4);

      const latest = viewersOfWeek.at(-1) || { viewers: 0 };
      const prev = viewersOfWeek.at(-2) || { viewers: 0 };
      let change = latest.viewers / prev.viewers - 1;
      if (change === Infinity) change = 1;
      else if (Number.isNaN(change)) change = 0;

      const changeIsLess = latest.viewers < prev.viewers;
      const noChange = latest.viewers === prev.viewers;
      const arrowId = changeIsLess ? 'arrow-down-right' : (noChange ? 'arrow-right' : 'arrow-up-right');
      const colorClass = changeIsLess ? 'icon--danger' : (noChange ? 'icon--neutral' : 'icon--success');

      // Build header + summary
      const header = `
        <div class="activity__header">
          <span>Profile activity</span>
          <button class="activity__button" type="button" aria-label="More">
            <svg class="icon" width="16" height="16" aria-hidden="true"><use href="#more"></use></svg>
          </button>
        </div>`;

      const summary = `
        <div class="activity__summary">
          <div class="activity__summary-start">
            <span class="activity__value">${compactNumber(latest.viewers)}</span><br />
            <span>People watched your videos today</span>
          </div>
          <div class="activity__summary-end">
            <strong class="activity__change">${pct(Math.abs(change))}
              <svg class="icon ${colorClass}" width="16" height="16" aria-hidden="true"><use href="#${arrowId}"></use></svg>
            </strong>
            <small>vs last day</small>
          </div>
        </div>`;

      // Build graph bars
      let graph = '';
      if (viewersOfWeek.length) {
        viewersOfWeek.forEach((item, i) => {
          const v = Math.min(item.viewers, viewersMax);
          const frac = v / viewersMax;
          const fracInv = 1 - frac;
          const hue = hueForFraction(frac);
          const knobWidthEm = 0.75; // same geometry as CSS
          const translateStart = `translateY(calc(100% - ${knobWidthEm}em))`;
          const translateEnd = `translateY(calc(${(fracInv*100).toFixed(4)}% - ${(fracInv*knobWidthEm).toFixed(4)}em))`;
          const valueFormatted = new Intl.NumberFormat(LOCALE).format(v);
          const shortDate = formatShortDate(item.date);

          const gradId = `bar-fill-${hue}-${i}`;

          graph += `
            <div class="activity__graph-bar" style="--translate-start: ${translateStart}; --translate-end: ${translateEnd};">
              <div class="activity__graph-bar-outer">
                <div class="activity__graph-bar-inner">
                  <svg class="activity__graph-bar-svg" viewBox="0 0 2 24" width="2px" height="24px" role="img" aria-label="Bar filled at ${(frac*100).toFixed(1)}%">
                    <defs>
                      <linearGradient id="${gradId}" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="0" stop-color="hsl(${hue},90%,50%)" />
                        <stop offset="1" stop-color="hsl(${hue},90%,70%)" />
                      </linearGradient>
                    </defs>
                    <g stroke-linecap="round" stroke-width="2">
                      <line x1="1" y1="1" x2="1" y2="23" />
                      <line x1="1.0001" y1="1" x2="1" y2="23" stroke="url(#${gradId})" />
                    </g>
                  </svg>
                  <div class="activity__graph-bar-knob-track">
                    <button type="button" class="activity__graph-bar-knob" style="background-color: hsl(${hue},90%,90%)" aria-label="${valueFormatted}"></button>
                  </div>
                </div>
                <div class="activity__tip-wrapper">
                  <div class="activity__tip"><small>${valueFormatted}</small></div>
                </div>
              </div>
              <small class="activity__graph-label">${shortDate}</small>
            </div>`;
        });
      } else {
        graph = '<div class="activity__graph-empty"><em>No data</em></div>';
      }

      slot.innerHTML = `
        <div class="activity__container">
          ${header}
          <div class="activity__body">
            ${summary}
            <div class="activity__graph">${graph}</div>
          </div>
        </div>`;

      // Kick off the bar animations by toggling a class after paint
      requestAnimationFrame(() => { slot.classList.remove('animate-bars'); slot.offsetHeight; slot.classList.add('animate-bars'); });
    }

    // ---------- Pet Selection Events ----------
    function attachPetHandlers() {
      document.querySelectorAll('.card-med[data-pet]').forEach(card => {
        card.addEventListener('click', () => {
          const pet = card.getAttribute('data-pet');
          const data = generatePetData(pet);
          renderActivityCard(data);
        });
      });
    }

    // ---------- Init ----------
    renderActivityCard(generatePetData('dog'));
    attachPetHandlers();
  </script>
</body>
</html>
